<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Practice Bootstrap 3 Affix 3</title>
    
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="ls7kuvIKSqVa_dcixqKvFwl393swvYMkHCkG-xtlCj0">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LP3ZQV2R3M"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-LP3ZQV2R3M');gtag('config','UA-106501-6');</script>
    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-6475907504235292" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style>

*, ::before, ::after { box-sizing: border-box; }
html { font-family: sans-serif; }

/* Affix を適用する対象の要素 */
.affix-target {
  z-index: 99999;  /* position: fixed になった時、他の要素の下に重ならないようにしておく */
  /* width を指定していない */
}

/* Affix を適用する対象の要素が position: fixed になった時の指定 */
.affix-target.affix {
  position: fixed !important;  /* .affix 自体に position: fixed 指定はあるものの、.affix-bottom が style 属性に position: relative を埋め込むので、それに勝るよう !important を指定しておく */
  top: 30px;  /* 画面上部からの位置を指定する。data-offset-top との辻褄が合う数値にしておくこと */
}

/* Affix の適用状態に応じて文字色を変える */
.affix-top    * { color: blue;  }  /* Affix 開始よりスクロール位置が上の場合 */
.affix        * { color: red;   }  /* position: fixed になった時 */
.affix-bottom * { color: green; }  /* Affix を解除するスクロール位置より下の場合 */

/* ページの高さを稼ぐためのコード */
.dummy-contents p {
  line-height: 3;
  margin-bottom: 3rem;
}

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>

$(() => {
  $('.affix-target').affix({
    offset: {
      top   : $('header').outerHeight(false),
      bottom: $('footer').outerHeight(true) + 400
    }
  })
    .on('affix.bs.affix', () => {
      // .affix-target の親要素の、padding の内側の幅を取得して、それを .affix-target の幅とする
      $('.affix-target').width($('.affix-target').parent().width());
    })
    .on('affix-top.bs.affix affix-bottom.bs.affix', () => {
      // .affix-top・.affix-bottom 時は上で指定した幅指定を解除し、親要素の幅に従わせる
      $('.affix-target').width('auto');
    });
  
  // ウィンドウリサイズに対応する
  $(window).resize(() => {
    // リサイズによる文章の折り返しなどでスクロール量が変わった場合に向けて、Affix の状況を再計算させる
    $('.affix-target').affix('checkPosition');
    // Affix 適用中の .affix-target のみ指定し、横幅を動的に設定する
    $('.affix-target.affix').width($('.affix-target').parent().width());
  });
});

    </script>
  </head>
  <body>

<header style="height: 250px; margin-bottom: 30px; color: #fff; background: #08f;">HEADER</header>

<div class="container-fluid">
  <div class="row">
    <div class="col-xs-8">
      <div class="dummy-contents">
        <h1>Practice Bootstrap 3 Affix 3</h1>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
      </div>
    </div>
    <div class="col-xs-4">
      <ul class="affix-target nav nav-pills nav-stacked">
        <li class="active"><a href="#">Menu 1</a></li>
        <li><a href="#">Menu 2</a></li>
        <li><a href="#">Menu 3</a></li>
        <li><a href="#">Menu 4</a></li>
      </ul>
    </div>
  </div>
</div>

<footer style="height: 500px; color: #fff; background: #444;">FOOTER</footer>

  </body>
</html>
